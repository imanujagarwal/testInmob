package com.inmobi.commons.core.configs;

import android.os.Handler;
import android.os.HandlerThread;
import android.os.Looper;
import android.os.Message;
import com.inmobi.commons.core.utilities.Logger;
import com.inmobi.commons.core.utilities.Logger.InternalLogLevel;
import java.lang.ref.WeakReference;
import java.util.ArrayList;
import java.util.HashMap;
import java.util.Iterator;
import java.util.List;
import java.util.Map;
import java.util.Map.Entry;
import java.util.Set;
import java.util.concurrent.ExecutorService;
import java.util.concurrent.Executors;
import org.json.JSONException;
import org.json.JSONObject;












public class b
{
  private static final String a = b.class.getSimpleName();
  
  private static Map<a, ArrayList<WeakReference<c>>> b;
  
  private static h c;
  private static d d;
  private HandlerThread e;
  private b f;
  private boolean g = false;
  
  public static abstract interface c {
    public abstract void a(a paramA);
  }
  
  private static class a {
    private static final b a = new b((byte)0);
  }
  
  public static b a() {
    return a.a();
  }
  
  private b() {
    b = new HashMap();
    
    e = new HandlerThread("ConfigBootstrapHandler");
    e.start();
    f = new b(e.getLooper());
    c = new h();
  }
  





  static class d
    implements b.c
  {
    d() {}
    





    public final void a(a paramA)
    {
      b.a((h)paramA);
    }
  }
  
  public final synchronized void c() {
    if (g)
    {

      g = false;
      f.sendEmptyMessage(5);
    }
  }
  









  private static void b(a paramA)
  {
    ArrayList localArrayList;
    








    if ((localArrayList = (ArrayList)b.get(paramA)) != null) {
      for (int i = 0; i < localArrayList.size(); i++) {
        if ((localArrayList.get(i) != null) && (((WeakReference)localArrayList.get(i)).get() != null)) {
          ((c)((WeakReference)localArrayList.get(i)).get()).a(paramA);
        }
      }
    }
  }
  









  public static void d()
  {
    String str1 = 
    
































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































      ce.a;String str2 = 
    










































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































      ce.b;
    if ((str1.trim().length() != 0) && (a(
    




































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































      "7.2.1", str1.trim()))) {
      Logger.a(Logger.InternalLogLevel.DEBUG, a, "A newer version (version " + str1 + ") of the InMobi SDK is available! You are currently on an older version (Version 7.2.1). Please download the latest InMobi SDK from " + 
      
        str2);
    }
  }
  

  private synchronized void c(a paramA)
  {
    c localC;
    if (!(localC = new c()).a(
    




































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































      "root"))
    {
      new StringBuilder("RootConfig not available. Fetching root and returning defaults for config type:").append(paramA.a());
      d(
      



































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































        new h());return;
    }
    
    localC.a(c);
    
    if (a(localC.b(
    



































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































      "root"), c.a(
      






































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































      "root"))) {
      d(
      










































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































        new h());
    }
    if (!localC.a(paramA.a()))
    {
      new StringBuilder("Requested config not present. Returning default and fetching. Config type:").append(paramA.a());
      d(paramA.d());
      return;
    }
    
    localC.a(paramA);
    
    if (a(localC.b(paramA.a()), c.a(paramA.a())))
    {
      new StringBuilder("Requested config expired. Returning currently cached and fetching. Config type:").append(paramA.a());
      
      d(paramA.d());
      return;
    }
    

    new StringBuilder("Serving config from cache. Config:").append(paramA.a());
  }
  

  private static boolean a(long paramLong1, long paramLong2)
  {
    return System.currentTimeMillis() - paramLong1 > paramLong2 * 1000L;
  }
  
  private void d(a paramA) {
    Message localMessage;
    f.obtainMessage()).what = 1;
    obj = paramA;
    f.sendMessage(localMessage);
  }
  



















































































































































































  private static boolean a(String paramString1, String paramString2)
  {
    paramString1 = paramString1.split("\\.");
    paramString2 = paramString2.split("\\.");
    


    try
    {
      String str = paramString1;i = paramString1.length; for (int k = 0; k < i; k++)
      {
        if (Integer.valueOf(str[k]).intValue() < 0)
          return false;
      }
      i = (str = paramString2).length; for (k = 0; k < i; k++)
      {
        if (Integer.valueOf(str[k]).intValue() < 0)
          return false;
      }
    } catch (NumberFormatException localNumberFormatException) {
      return false;
    }
    
    int i = paramString1.length < paramString2.length ? paramString1.length : paramString2.length;
    for (int j = 0; j < i; j++) {
      if (!paramString1[j].equals(paramString2[j])) {
        return Integer.valueOf(paramString1[j]).intValue() < Integer.valueOf(paramString2[j]).intValue();
      }
    }
    
    return paramString1.length < paramString2.length;
  }
  
  public final synchronized void b()
  {
    b localB;
    Iterator localIterator;
    if (!g)
    {

      g = true;
      com.inmobi.commons.core.e.b.a().a("root", 
      



























































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































        cf);
      if (d == null) {
        d = new d();
        a(c, d);
      }
      localB = this;
      













































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































      for (localIterator = b.entrySet().iterator(); localIterator.hasNext();) {
        a localA = (a)((Map.Entry)localIterator.next()).getKey();
        localB.c(localA);
        b(localA);
      }
    }
  }
  
  public final synchronized void a(a paramA, c paramC)
  {
    if (!g) {
      new StringBuilder("Config component not yet started, config can't be fetched. Requested type:").append(paramA.a());
      return;
    }
    
    c localC = paramC;paramC = paramA;
    










































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































    ArrayList localArrayList;
    









































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































    if ((localArrayList = (ArrayList)b.get(paramC)) == null) {
      localArrayList = new ArrayList();
    }
    localArrayList.add(localC == null ? null : new WeakReference(localC));
    b.put(paramC, localArrayList);c(paramA);
  }
  
  static final class b
    extends Handler
    implements e.a
  {
    private List<a> a = new ArrayList();
    private Map<String, Map<String, a>> b = new HashMap();
    private Map<String, a> c = new HashMap();
    private ExecutorService d;
    
    b(Looper paramLooper) {
      super();
    }
    


























































    private boolean a(String paramString)
    {
      boolean bool = false;
      
      if ((b.get(b.f().b(paramString)) != null) && 
        (((Map)b.get(b.f().b(paramString))).containsKey(paramString))) {
        bool = true;
      }
      
      if ((c != null) && 
        (c.containsKey(paramString))) {
        bool = true;
      }
      return bool;
    }
    

























    private void a(List<a> paramList)
    {
      for (int i = 0; i < paramList.size(); i++) {
        a localA = (a)paramList.get(i);
        
        HashMap localHashMap;
        if ((localHashMap = (HashMap)b.get(b.f().b(localA.a()))) == null) {
          localHashMap = new HashMap();
          b.put(b.f().b(localA.a()), localHashMap);
        }
        localHashMap.put(localA.a(), localA);
      }
    }
    



































    public final void a()
    {
      sendEmptyMessage(4);
    }
    
    public final void handleMessage(Message paramMessage)
    {
      switch (what) {
      case 1: 
        paramMessage = (a)obj;
        b.e();new StringBuilder("Fetch requested for config:").append(paramMessage.a()).append(". IsAlreadyScheduled:").append(a(paramMessage.a()));
        
        if (!a(paramMessage.a())) {
          a.add(paramMessage);
          
          if (!hasMessages(2)) {
            sendEmptyMessage(2);
          }
        } else {
          b.e();new StringBuilder("Config fetching already in progress:").append(paramMessage.a()); return;
        }
        
        break;
      case 2: 
        sendEmptyMessageDelayed(3, 
        
































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































          fc * 1000);return;
      
      case 3: 
        a(a);
        a.clear();
        
        if ((d == null) || (d.isShutdown())) {
          d = Executors.newFixedThreadPool(1);
          sendEmptyMessage(4); return;
        }
        
        break;
      case 4: 
        if (!b.isEmpty()) {
          paramMessage = (Map.Entry)b.entrySet().iterator().next();
          c = ((Map)paramMessage.getValue());
          b.remove(paramMessage.getKey());
          Map localMap = c;Object localObject1 = (String)paramMessage.getKey();paramMessage = this;
          












































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































          int i = 
          




































































































































































































































































































































































































































































































































































































































































































































































































































































































































            fb;int j = 
          


































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































            fa;com.inmobi.commons.core.utilities.uid.d localD = new com.inmobi.commons.core.utilities.uid.d(
          






































































































































































































































































































































































































































































































































































































































































































































































































































































































































            fp.a);
          int k;
          if (((k = com.inmobi.commons.core.utilities.b.e.d()) == 0) && 
            (localMap.containsKey("root"))) {
            localMap = b.a(localMap);
            k = 1;
          }
          

          localObject1 = new f(localMap, localD, (String)localObject1, j, i, k);
          Object localObject2 = null;
          if (localMap.containsKey("root")) {
            localObject2 = b.f().e();
            localObject2 = new f(b.a(localMap), localD, (String)localObject2, j, i, true, k);
          }
          

          localObject2 = new e(paramMessage, (f)localObject1, (f)localObject2);
          d.execute((Runnable)localObject2);
        }
        else
        {
          b.e();
          sendEmptyMessage(5); return;
        }
        






































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































        break;
      case 5: 
        paramMessage = this; if ((d != null) && (!d.isShutdown())) {
          c = null;
          b.clear();
          paramMessage.removeMessages(3);
          d.shutdownNow();
        }
        break;
      }
    }
    
    public final void a(ConfigNetworkResponse.ConfigResponse paramConfigResponse)
    {
      Object localObject1 = new c();
      
      if (!paramConfigResponse.a()) {
        if (
        


















































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































          a == ConfigNetworkResponse.ConfigResponse.ConfigResponseStatus.NOT_MODIFIED) {
          b.e();new StringBuilder("Config not modified status from server:").append(
          





















































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































            b.a());((c)localObject1).a(
          






































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































            b.a(), System.currentTimeMillis());return;
        }
        
        localObject1 = 
        
































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































          b;Object localObject2 = localObject1;
        








































































































































































































































































































































































































































































































































































































































































































































































































































































        try
        {
          a.a(((a)localObject1).a() + "_config", ((a)localObject1).b().toString());
          localObject2.a(((a)localObject1).a(), System.currentTimeMillis());
        }
        catch (JSONException localJSONException1) {}
        try
        {
          (localObject1 = new HashMap()).put("configName", 
          




































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































            b.a());((Map)localObject1).put("latency", "2147483647");com.inmobi.commons.core.e.b.a();com.inmobi.commons.core.e.b.a("root", "ConfigFetched", (Map)localObject1);
        } catch (Exception localException) {
          b.e();new StringBuilder("Error in submitting telemetry event : (")
            .append(localException.getMessage()).append(")");
        }
        try
        {
          b.e();new StringBuilder("Config cached successfully:").append(
          



































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































            b.a());b.e();new StringBuilder("Config cached successfully:").append(
          






































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































            b.b().toString());b.a(
          






































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































            b);return; } catch (JSONException localJSONException2) { return;
        } }
      b.e();new StringBuilder("Config fetching failed:").append(
      




















































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































        b.a()).append(", Error code:").append(
        














































































































































































































































































































































































































































































































































































































































































































































































































































































        c.a);
    }
  }
}
