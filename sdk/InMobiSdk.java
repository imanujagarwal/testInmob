package com.inmobi.sdk;

import android.app.Activity;
import android.content.ContentValues;
import android.content.Context;
import android.content.Intent;
import android.content.pm.PackageManager;
import android.location.Location;
import android.os.Build.VERSION;
import android.os.SystemClock;
import com.inmobi.a.o;
import com.inmobi.ads.c.b;
import com.inmobi.ads.cache.AssetStore;
import com.inmobi.ads.cache.d;
import com.inmobi.b.a.3;
import com.inmobi.commons.core.configs.b.c;
import com.inmobi.commons.core.e.b.2;
import com.inmobi.commons.core.utilities.Logger;
import com.inmobi.commons.core.utilities.Logger.InternalLogLevel;
import com.inmobi.commons.core.utilities.a.b;
import com.inmobi.commons.core.utilities.b.g;
import java.io.File;
import java.util.HashMap;
import java.util.Iterator;
import java.util.List;
import java.util.Locale;
import java.util.Map;
import java.util.concurrent.ExecutorService;
import java.util.concurrent.Executors;
import java.util.concurrent.atomic.AtomicBoolean;
import org.json.JSONObject;




















public final class InMobiSdk
{
  private static final String TAG = InMobiSdk.class.getSimpleName();
  private static final ExecutorService COMPONENT_SERVICE = Executors.newSingleThreadExecutor();
  
  public static final String IM_GDPR_CONSENT_AVAILABLE = "gdpr_consent_available";
  

  public static enum LogLevel
  {
    NONE, 
    ERROR, 
    DEBUG;
    
    private LogLevel() {} }
  
  public static enum Education { HIGH_SCHOOL_OR_LESS("highschoolorless"), 
    COLLEGE_OR_GRADUATE("collegeorgraduate"), 
    POST_GRADUATE_OR_ABOVE("postgraduateorabove");
    
    private String a;
    
    private Education(String paramString) {
      a = paramString;
    }
    
    public final String toString()
    {
      return a;
    }
  }
  
  public static enum Gender {
    FEMALE("f"), 
    MALE("m");
    
    private String a;
    
    private Gender(String paramString) {
      a = paramString;
    }
    
    public final String toString()
    {
      return a;
    }
  }
  
  public static enum AgeGroup {
    BELOW_18("below18"), 
    BETWEEN_18_AND_24("between18and24"), 
    BETWEEN_25_AND_29("between25and29"), 
    BETWEEN_30_AND_34("between30and34"), 
    BETWEEN_35_AND_44("between35and44"), 
    BETWEEN_45_AND_54("between45and54"), 
    BETWEEN_55_AND_65("between55and65"), 
    ABOVE_65("above65");
    
    private String a;
    
    private AgeGroup(String paramString) {
      a = paramString;
    }
    
    public final String toString()
    {
      return a;
    }
  }
  





  public static void init(Context paramContext, String paramString)
  {
    init(paramContext, paramString, null);
  }
  







  public static void init(Context paramContext, String paramString, JSONObject paramJSONObject)
  {
    long l = SystemClock.elapsedRealtime();
    try {
      com.inmobi.commons.core.utilities.b.e.a(paramJSONObject);
      if (Build.VERSION.SDK_INT < 14) {
        Logger.a(Logger.InternalLogLevel.ERROR, TAG, "The minimum supported Android API level is 14, SDK could not be initialized.");
        


        return;
      }
      
      if (paramContext == null) {
        Logger.a(Logger.InternalLogLevel.ERROR, TAG, "Context supplied as null, SDK could not be initialized.");
        
        return;
      }
      
      if ((paramString == null) || (0 == paramString.trim().length())) {
        Logger.a(Logger.InternalLogLevel.ERROR, TAG, "Account id cannot be null or empty. Please provide a valid account id.");
        
        return;
      }
      


      (paramJSONObject = new Intent()).setClassName(paramContext.getPackageName(), "com.inmobi.rendering.InMobiAdActivity");
      if (paramContext.getPackageManager().resolveActivity(paramJSONObject, 65536) == null) {
        Logger.a(Logger.InternalLogLevel.ERROR, TAG, "The activity com.inmobi.rendering.InMobiAdActivity not present in AndroidManifest. SDK could not be initialized.");
        

        return;
      }
      

      if ((!com.inmobi.commons.core.utilities.e.a(paramContext, "ads", "android.permission.INTERNET")) || 
        (!com.inmobi.commons.core.utilities.e.a(paramContext, "ads", "android.permission.ACCESS_NETWORK_STATE"))) {
        Logger.a(Logger.InternalLogLevel.ERROR, TAG, "Please grant the mandatory permissions : INTERNET and ACCESS_NETWORK_STATE, SDK could not be initialized.");
        

        return;
      }
      

      if ((!com.inmobi.commons.core.utilities.e.a(paramContext, "ads", "android.permission.ACCESS_COARSE_LOCATION")) && 
        (!com.inmobi.commons.core.utilities.e.a(paramContext, "ads", "android.permission.ACCESS_FINE_LOCATION"))) {
        Logger.a(Logger.InternalLogLevel.ERROR, TAG, "Please grant the location permissions (ACCESS_COARSE_LOCATION or ACCESS_FINE_LOCATION, or both) for better ad targeting.");
      }
      







      if (((paramString = paramString.trim()).length() != 32) && (paramString.length() != 36)) {
        Logger.a(Logger.InternalLogLevel.DEBUG, TAG, "Invalid account id passed to init. Please provide a valid account id.");
      }
      

      if (com.inmobi.commons.a.a.a()) {
        try
        {
          com.inmobi.commons.core.e.b.a();com.inmobi.commons.core.e.b.a("root", "InitRequested", null); return;
        } catch (Exception paramJSONObject) {
          new StringBuilder("Error in submitting telemetry event : (").append(paramJSONObject.getMessage()).append(")"); return;
        }
      }
      
      Object localObject;
      if (hasSdkVersionChanged(paramContext)) {
        paramJSONObject = a.a(paramContext);
        com.inmobi.commons.a.b.a(paramContext, paramJSONObject);
        localObject = 
        


























































































































































































































































































































































































































































































































































































































































































































































































































































          "7.2.1";
        






















        com.inmobi.commons.core.d.c.a(paramContext, "sdk_version_store").a("sdk_version", (String)localObject);resetMediaCache(paramContext.getApplicationContext());
      }
      com.inmobi.commons.a.a.a(paramContext, paramString);
      







      com.inmobi.commons.core.configs.b.a().b();
      com.inmobi.commons.core.e.b.a().b();
      

      if (
      






































































































































































































































































































































































































































































































































































































































































































































































































































































        com.inmobi.commons.core.d.c.a(paramContext, "sdk_version_store").b("db_deletion_failed", false))
      {
        for (localObject = (paramJSONObject = a.b(paramContext)).iterator(); ((Iterator)localObject).hasNext();) {
          sendDbDeletionTelemetryEvent((String)((Iterator)localObject).next());
        }
        

        if (paramJSONObject.isEmpty()) {
          com.inmobi.commons.a.b.a(paramContext, false);
        }
      }
      
      g.b();
      initComponents();
      com.inmobi.commons.core.configs.b.a();com.inmobi.commons.core.configs.b.d();
      COMPONENT_SERVICE.execute(new Runnable()
      {

        public final void run()
        {
          try
          {
            com.inmobi.ads.b.c();
            AssetStore.a().b();
            Object localObject1 = AssetStore.a();
            



































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































            synchronized (AssetStore.e) {
              List localList;
              if ((localList = d.b()).isEmpty()) {
                return;
              }
              for (Object localObject3 = localList.iterator(); ((Iterator)localObject3).hasNext();) {
                localObject5 = localObject4 = (com.inmobi.ads.cache.a)((Iterator)localObject3).next(); if (
                
















































































































































































































































































































































































































































































































































































































































































































































































































































                  (System.currentTimeMillis() > h ? 1 : 0) != 0) {
                  AssetStore.a((com.inmobi.ads.cache.a)localObject4);
                }
              }
              

































































































































































































































































































































































































































































































































              Object localObject4;
              
































































































































































































































































































































































































































































































































              for (;;)
              {
                localObject3 = d.b();
                long l = 0L;
                for (localObject3 = ((List)localObject3).iterator(); ((Iterator)localObject3).hasNext();) { localObject4 = (com.inmobi.ads.cache.a)((Iterator)localObject3).next();
                  localObject4 = new File(
                  



































































































































































































































































































































































































































































































































































































































































































































































































                    e);l += ((File)localObject4).length();
                }
                new StringBuilder("MAX CACHESIZE ").append(
                
































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































                  b.d);
                if (l <= 
                






































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































                  b.d) {
                  break;
                }
                if ((localObject3 = 
                









































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































                  (
                  
                  localObject3 = com.inmobi.commons.core.d.b.a().a("asset", d.a, null, null, null, null, "ts ASC ", null)).size() == 0 ? null : d.a((ContentValues)((List)localObject3).get(0))) == null) {
                  break;
                }
                AssetStore.a((com.inmobi.ads.cache.a)localObject3);
              }
              Object localObject5 = localList;
              












































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































              if ((localObject1 = com.inmobi.commons.a.a.a(com.inmobi.commons.a.a.b())).exists())
              {
                if ((localObject1 = ((File)localObject1).listFiles()) != null) {
                  for (localObject4 : localObject1) {
                    int k = 0;
                    for (com.inmobi.ads.cache.a localA : (List)localObject5) {
                      if (((File)localObject4).getAbsolutePath().equals(
                      























































































































































































































































































































































































































































































































































































































































































































































































































                        e))
                      {
                        k = 1;
                        break;
                      }
                    }
                    if (k == 0)
                    {
                      new StringBuilder("found Orphan file ").append(((File)localObject4).getAbsolutePath());
                      
                      ((File)localObject4).delete();
                    }
                  }
                }
              }
            }
          }
          catch (Exception localException)
          {
            new StringBuilder("Error in starting Asset Cache : (").append(localException.getMessage()).append(")");
          }
        }
      });
      
      if ((paramContext instanceof Activity))
      {
        if ((paramJSONObject = com.inmobi.commons.core.utilities.a.a()) != null) {
          paramJSONObject.a(new a.b()
          {
            public final void a(boolean paramAnonymousBoolean) {
              com.inmobi.commons.a.a.b(paramAnonymousBoolean);
              try {
                if (paramAnonymousBoolean) {
                  InMobiSdk.access$100();return;
                }
                InMobiSdk.access$200(); return;
              }
              catch (Exception paramAnonymousBoolean)
              {
                new StringBuilder("Encountered unexpected error in the onFocusChanged handler: ").append(paramAnonymousBoolean.getMessage());
                Logger.a(Logger.InternalLogLevel.DEBUG, InMobiSdk.TAG, "SDK encountered an unexpected error; some components may not work as advertised");
              }
            }
          });
        }
      }
      
      try
      {
        com.inmobi.commons.core.e.b.a();com.inmobi.commons.core.e.b.a("root", "InitRequested", null);
      } catch (Exception paramJSONObject) {
        new StringBuilder("Error in submitting telemetry event : (").append(paramJSONObject.getMessage()).append(")");
      }
      








      Logger.a(Logger.InternalLogLevel.DEBUG, TAG, "InMobi SDK initialized with account id: " + paramString);
    }
    catch (Exception paramJSONObject)
    {
      com.inmobi.commons.a.a.c();
      Logger.a(Logger.InternalLogLevel.ERROR, TAG, "SDK could not be initialized; an unexpected error was encountered");
      
      new StringBuilder("Encountered unexpected error while initializing the SDK: ")
        .append(paramJSONObject.getMessage());
    }
    



    try
    {
      (paramJSONObject = new HashMap()).put("initTime", Long.valueOf(SystemClock.elapsedRealtime() - l));
      com.inmobi.commons.core.e.b.a();com.inmobi.commons.core.e.b.a("root", "SdkInitialized", paramJSONObject);
    } catch (Exception paramJSONObject) {
      new StringBuilder("Error in submitting telemetry event : (").append(paramJSONObject.getMessage()).append(")");
    }
    
    printGrantedPermissions();
  }
  





  public static void updateGDPRConsent(JSONObject paramJSONObject)
  {
    com.inmobi.commons.core.utilities.b.e.a(paramJSONObject);
  }
  





  public static void setApplicationMuted(boolean paramBoolean)
  {
    com.inmobi.commons.a.a.a(paramBoolean);
  }
  





  private static void sendDbDeletionTelemetryEvent(String paramString)
  {
    if (com.inmobi.commons.a.a.a()) {
      try
      {
        HashMap localHashMap;
        (localHashMap = new HashMap()).put("filename", paramString);
        localHashMap.put("description", "DB Deleted : " + paramString);
        com.inmobi.commons.core.e.b.a();com.inmobi.commons.core.e.b.a("ads", "PersistentDataCleanFail", localHashMap); return;
      }
      catch (Exception localException) {
        new StringBuilder("Error in submitting telemetry event : (").append(localException.getMessage()).append(")");
      }
    }
  }
  



  private static void printGrantedPermissions()
  {
    COMPONENT_SERVICE.execute(new Runnable()
    {
      public final void run() {
        String[] arrayOfString = { "android.permission.ACCESS_COARSE_LOCATION", "android.permission.ACCESS_FINE_LOCATION", "android.permission.ACCESS_WIFI_STATE", "android.permission.CHANGE_WIFI_STATE", "android.permission.VIBRATE", "android.permission.READ_CALENDAR", "android.permission.WRITE_CALENDAR", "com.google.android.gms.permission.ACTIVITY_RECOGNITION" };
        




        StringBuilder localStringBuilder = new StringBuilder("Permissions granted to SDK are :\nandroid.permission.INTERNET\nandroid.permission.ACCESS_NETWORK_STATE");
        

        for (int i = 0; i < 8; i++) { String str = arrayOfString[i];
          if (com.inmobi.commons.core.utilities.e.a(com.inmobi.commons.a.a.b(), "ads", str)) {
            localStringBuilder.append("\n").append(str);
          }
        }
        Logger.a(Logger.InternalLogLevel.DEBUG, InMobiSdk.TAG, localStringBuilder.toString());
      }
    });
  }
  
  private static void initComponents() {
    try {
      COMPONENT_SERVICE.execute(new Runnable()
      {





        public final void run()
        {





          try
          {




            com.inmobi.commons.core.utilities.uid.c localC = com.inmobi.commons.core.utilities.uid.c.a();
            







































































































































































































































































































































































































































































































































































































































































            try
            {
              com.inmobi.commons.core.utilities.uid.c.c();
              localC.b();
            }
            catch (Exception localException1) {
              new StringBuilder("SDK encountered an unexpected error while initializing the UID helper component; ").append(localException1.getMessage());
            }
            com.inmobi.commons.core.utilities.uid.c.a().b();
            com.inmobi.commons.core.configs.b.a().b();
            com.inmobi.rendering.a.c.a().b();
            Object localObject = com.inmobi.commons.core.a.a.a();
            




































































































































































































































































































































































































































































































































































































































































































































































            com.inmobi.commons.core.a.a.b.set(false);
            com.inmobi.commons.core.configs.b.a().a(c, (b.c)localObject);
            d = 
            























































































































              c.a;a.execute(new com.inmobi.commons.core.a.a.2((com.inmobi.commons.core.a.a)localObject));com.inmobi.commons.core.e.b.a().b();localObject = com.inmobi.b.a.a();
            









































































































































































































































































































































































































































































































































































































































































































































































































































































































            com.inmobi.b.a.b.set(false);
            

            com.inmobi.commons.core.utilities.b.e.c();
            com.inmobi.commons.core.configs.b.a().a(c, (b.c)localObject);
            d = 
            



















































































































































































































































































































































































































































































































































































              c.b;a.execute(new com.inmobi.b.a.2((com.inmobi.b.a)localObject));com.inmobi.ads.b.a();o.a().b();com.inmobi.ads.c.b.d().a();com.inmobi.ads.c.a.a("native").a();AssetStore.a().b(); return;
          }
          catch (Exception localException2)
          {
            new StringBuilder("Encountered unexpected error in starting SDK components: ").append(localException2.getMessage());
            Logger.a(Logger.InternalLogLevel.DEBUG, InMobiSdk.TAG, "SDK encountered unexpected error while starting internal components");
          }
          
        }
      }); return;
    }
    catch (Exception localException)
    {
      new StringBuilder("Encountered unexpected error in starting SDK components: ").append(localException.getMessage());
      Logger.a(Logger.InternalLogLevel.DEBUG, TAG, "SDK encountered unexpected error while starting internal components");
    }
  }
  
  private static void deInitComponents()
  {
    try {
      COMPONENT_SERVICE.execute(new Runnable()
      {
        public final void run() {
          try {
            com.inmobi.commons.core.configs.b.a().c();
            Object localObject = com.inmobi.commons.core.e.b.a();
            







































































































































































































































































































































































































































































































































































































































































            com.inmobi.commons.core.e.b.b.set(true);
            a.execute(new b.2((com.inmobi.commons.core.e.b)localObject));localObject = com.inmobi.b.a.a();
            








































































            com.inmobi.b.a.b.set(true);
            a.execute(new a.3((com.inmobi.b.a)localObject));o.a().c();com.inmobi.ads.c.b.d().b();com.inmobi.ads.c.a.a("native").b();
            












































































































































































































































            ad.set(true);
            ((AssetStore)localObject).c();
          }
          catch (Exception localException)
          {
            new StringBuilder("Encountered unexpected error in stopping SDK components; ").append(localException.getMessage());
            Logger.a(Logger.InternalLogLevel.ERROR, InMobiSdk.TAG, "SDK encountered unexpected error while stopping internal components");
          }
          
        }
      }); return;
    }
    catch (Exception localException)
    {
      new StringBuilder("Encountered unexpected error in stopping SDK components; ").append(localException.getMessage());
      Logger.a(Logger.InternalLogLevel.ERROR, TAG, "SDK encountered unexpected error while stopping internal components");
    }
  }
  
  private static void resetMediaCache(final Context paramContext)
  {
    File localFile = com.inmobi.commons.a.a.a(paramContext);
    COMPONENT_SERVICE.execute(new Runnable()
    {
      public final void run() {
        com.inmobi.commons.a.a.a(a);
        com.inmobi.commons.a.a.b(paramContext);
      }
    });
    if (!localFile.mkdir()) { localFile.isDirectory();
    }
  }
  














  public static void setLogLevel(LogLevel paramLogLevel)
  {
    switch (7.a[paramLogLevel.ordinal()]) {
    case 1: 
      Logger.a(Logger.InternalLogLevel.NONE);
      return;
    case 2: 
      Logger.a(Logger.InternalLogLevel.ERROR);
      return;
    case 3: 
      Logger.a(Logger.InternalLogLevel.DEBUG);
    }
    
  }
  




  public static void setAge(int paramInt)
  {
    g.a(paramInt);
  }
  




  public static void setAgeGroup(AgeGroup paramAgeGroup)
  {
    g.a(paramAgeGroup.toString().toLowerCase(Locale.ENGLISH));
  }
  




  public static void setAreaCode(String paramString)
  {
    g.b(paramString);
  }
  




  public static void setPostalCode(String paramString)
  {
    g.c(paramString);
  }
  






  public static void setLocationWithCityStateCountry(String paramString1, String paramString2, String paramString3)
  {
    g.d(paramString1);
    g.e(paramString2);
    g.f(paramString3);
  }
  




  public static void setYearOfBirth(int paramInt)
  {
    g.b(paramInt);
  }
  




  public static void setGender(Gender paramGender)
  {
    g.g(paramGender.toString().toLowerCase(Locale.ENGLISH));
  }
  




  public static void setEducation(Education paramEducation)
  {
    g.h(paramEducation.toString().toLowerCase(Locale.ENGLISH));
  }
  




  public static void setLanguage(String paramString)
  {
    g.i(paramString);
  }
  




  public static void setInterests(String paramString)
  {
    g.j(paramString);
  }
  




  public static void setLocation(Location paramLocation)
  {
    g.a(paramLocation);
  }
  
  private static boolean hasSdkVersionChanged(Context paramContext)
  {
    return (com.inmobi.commons.a.b.a(paramContext) == null) || (!com.inmobi.commons.a.b.a(paramContext).equals(
    






















































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































      "7.2.1"));
  }
  
  public static String getVersion()
  {
    return 
    





























































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































      "7.2.1";
  }
  
  public InMobiSdk() {}
}
